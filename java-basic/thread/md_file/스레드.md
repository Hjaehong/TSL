## Thread

---

í”„ë¡œì„¸ìŠ¤ ë‚´ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê°€ì¥ ì‘ì€ ì‹¤í–‰ ë‹¨ìœ„

í”„ë¡œì„¸ìŠ¤ ë‚´ì—ì„œ ë©”ëª¨ë¦¬ì™€ ë¦¬ì†ŒìŠ¤ë¥¼ ê³µìœ í•˜ë©´ì„œ ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ë˜ì–´ ë³‘ë ¬ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

ì²˜ë¦¬ ì†ë„ë¥¼ ë†’í ìˆ˜ ìˆë‹¤

**êµ¬ì„±**

1. ìŠ¤ë ˆë“œ ID : ìŠ¤ë ˆë“œë¥¼ ì‹ë³„í•˜ëŠ” ìœ ì¼ ê°’
2. í”„ë¡œê·¸ë¨ ì¹´ìš´í„° : ìŠ¤ë ˆë“œê°€ ì‹¤í–‰í•  ë‹¤ìŒ ëª…ë ¹ì–´ì˜ ì£¼ì†Œë¥¼ ê°€ë¥´í‚¤ëŠ” ë ˆì§€ìŠ¤í„°
3. ë ˆì§€ìŠ¤í„° ì§‘í•© : ìŠ¤ë ˆë“œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë° ì‚¬ìš©í•˜ëŠ” ë ˆì§€ìŠ¤í„° ì§‘í•©
4. ìŠ¤í… : í•¨ìˆ˜ í˜¸ì¶œ, ë¡œì»¬ ë³€ìˆ˜ì— ëŒ€í•œ ë©”ëª¨ë¦¬ë¥¼ ì œê³µí•˜ëŠ” ë°ì´í„° êµ¬ì¡°

**ì‚¬ìš©ì‹œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œì **

- ë™ê¸°í™” ë¬¸ì œ
    - ì—¬ëŸ¬ ì“°ë ˆë“œê°€ ë™ì‹œì— ê³µìœ  ìì›ì— ì ‘ê·¼ ì‹œ ë°œìƒ
    â†’ ë™ê¸°í™” ë©”ì»¤ë‹ˆì¦˜ì„ ì‚¬ìš©í•´ì•¼í•œë‹¤.
- ê²½ìŸ ìƒíƒœ
    - ë‘ ê°œì´ìƒì˜ ìŠ¤ë ˆë“œê°€ ë³€ìˆ˜ë‚˜ ë°ì´í„°ì— ë™ì‹œì— ì ‘ê·¼í•˜ì—¬ ë³€ê²½ì„ ì‹œë„í•  ë•Œ ë°œìƒ 
    â†’ë®¤í…ìŠ¤, ì„¸ë§ˆí¬ì–´ ê¸°ë²•ì„ ì‚¬ìš©í•˜ì—¬ í•´ê²°
- ë°ë“œë½
    - ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì ìœ í•˜ê³  ì ê¸ˆì„ í’€ì–´ì£¼ì§€ ì•Šì•„ ìƒí˜¸ ëŒ€ê¸° ìƒíƒœì— ë¹ ì§€ëŠ” í˜„ìƒ 
    ( ê° ìŠ¤ë ˆë“œê°€ ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ì‚¬ìš©í•˜ê³  ìˆëŠ” ìì›ì„ ê¸°ë‹¤ë¦¬ë©´ì„œ ë¬´í•œì • ëŒ€ê¸°í•˜ê³  ìˆëŠ” ìƒí™© )
    â†’ ìì›ì˜ í• ë‹¹ ìˆœì„œë¥¼ ì •í•˜ê±°ë‚˜, í•„ìš”í•œ ìì›ì„ í•œ ë²ˆì— ìš”ì²­í•˜ê±°ë‚˜, ë‹¤ì‹œ ì‹œë„í•´ì„œ í•´ê²° í•´ì•¼í•œë‹¤.
- ìŠ¤ë ˆë“œ ë³„ ì˜¤ë²„í—¤ë“œ
    - ìŠ¤ë ˆë“œ ìƒì„±, ê´€ë¦¬ë„ ë¹„ìš©ì´ ë“¤ì–´ì„œ ì ì ˆí•œ ìˆ˜ì˜ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ì—…í•´ì•¼í•œë‹¤, ë„ˆë¬´ ë§ì´ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì˜¤ë²„í—¤ë“œê°€ ì¦ê°€í•˜ì—¬ ì„±ëŠ¥ì´ ì €í•˜ ëœë‹¤.

```java
package basic;
/**
 * Thread ì‚¬ìš© ë°©ë²•
 * 1. Threadë¥¼ ìƒì†í•´ì„œ run() ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œ í•œë‹¤.
 * 2. Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ê³  ê·¸ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ Thread í´ë˜ìŠ¤ì˜ ìƒì„±ìì— ì „ë‹¬*/
public class BankThread {

    // ë‚¨ì€ ê¸ˆì•¡
    private int balance;

    public BankThread(int balance) {
        this.balance = balance;
        System.out.println("ìƒì„±ì ë©”ì„œë“œ");
    }

    // ì…ê¸ˆ
    /* synchronized : ë™ì‹œì„±ì„ ì œì–´ í•˜ê¸°ìœ„í•œ ì‚¬ìš©ë˜ëŠ” í‚¤ì›Œë“œ
     * ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ê°™ì€ ë™ì‹œì— ê°™ì€ ê°ì²´ì˜ ë©”ì„œë“œë‚˜ ì½”ë“œ ë¸”ë¡ì— ì ‘ê·¼í•˜ëŠ”ê±¸ ë§‰ì•„ ì¤€ë‹¤, ê²½ìŸ ìƒíƒœì™€ ê°™ì€ ë™ì‹œì„± ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë° ë„ì›€ì„ ì¤€ë‹¤.
     * ì¦‰, ì´ ë©”ì„œë“œëŠ” í•œ ë²ˆì— í•œ ìŠ¤ë ˆë“œë§Œ ì‹¤í–‰ë  ìˆ˜ ìˆë‹¤.*/
    public synchronized void deposit(int amount) {

        System.out.println("Deposit = " + amount);
        int tempBalance = this.balance;
        try{
            Thread.sleep(1000);
        // ìŠ¤ë ˆë“œê°€ ëŒ€ê¸°, íœ´ì‹ ì¤‘ì´ê±°ë‚˜ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ì ìœ  ì¤‘ì¸ ìƒíƒœì—ì„œ í™œë™ ì „, í™œë™ ì¤‘ ìŠ¤ë ˆë“œê°€ ì¤‘ë‹¨ ë  ë•Œ ë°œìƒ
        } catch (InterruptedException e){
            // ì—ëŸ¬ìŠ¤íŠ¸ë¦¼ì— ì¶œë ¥?
            e.printStackTrace();
        }

        tempBalance += amount;
        this.balance = tempBalance;
        System.out.println("Deposit = " + amount);
    }

    // ì¶œê¸ˆ
    public synchronized void withdraw(int amount) {
        System.out.println("withdraw = " + amount);

        int tempBalance = this.balance;
        try{
            Thread.sleep(1000);
        }catch (InterruptedException e){
            e.printStackTrace();
        }

        tempBalance -= amount;
        this.balance = tempBalance;
        System.out.println("withdraw = " + amount);

    }

    // main ë©”ì„œë“œì—ì„œ balanceë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ getter ì‚¬ìš©
    public int getBalance() {
        return balance;
    }

    public static void main(String[] args) {
        BankThread bankT = new BankThread(1000);

        /* Runnable : ìë°”ì—ì„œ ìŠ¤ë ˆë“œë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•œ ì¸í„°í˜ì´ìŠ¤
         * ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ë ¤ë©´ Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ ì •ì˜í•˜ê³  run() ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œí•´ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰í•  ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ í•œë‹¤.
         * depositRunnable, withdrawRunnableì€ êµ¬í˜„ í´ë˜ìŠ¤
         * */
        Runnable depositRunnable = () -> {
            for(int i = 0; i < 10; i++) {
                // 100ì›ì”© 10ë²ˆ ì¦ê°€
                bankT.deposit(100);
            }
        };
				// 1. runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” í´ë˜ìŠ¤ withdrawRunnable
        Runnable withdrawRunnable = () -> {
            for (int i = 0; i < 10; i++){
                bankT.withdraw(100);
            }
        };
				
				// 2. withdrawRunnableí´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ Thread ìƒì„±ìì— ì „ë‹¬
        Thread t1 = new Thread(depositRunnable);
        Thread t2 = new Thread(withdrawRunnable);
		
        t1.start();
        t2.start();

        try{
						// í˜„ì¬ ìŠ¤ë ˆë“œê°€ ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ë  ë•Œ ì¢…ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê¸° ìœ„í•´ ì‚¬ìš©
            t1.join();
            t2.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        System.out.println("ë§ˆì§€ë§‰ ê³„ì¢Œ ì”ê¸ˆ = " + bankT.getBalance());
    }
}
```

## ëŒë‹¤ì‹

---

<aside>
ğŸ’¡ ê°„ê²°í•œ ë°©ì‹ìœ¼ë¡œ **ìµëª… í•¨ìˆ˜**ë¥¼ í‘œí˜„

</aside>

> ìµëª…í•¨ìˆ˜(ìµëª…í´ë˜ìŠ¤) ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„, í´ë˜ìŠ¤ ìƒì†ì‹œ ì‚¬ìš© 
â†’ í´ë˜ìŠ¤ ì„ ì–¸, ê°ì²´ì˜ ìƒì„±ì„ ë™ì‹œì— ìˆ˜í–‰í•˜ëŠ” ì´ë¦„ì—†ëŠ” í´ë˜ìŠ¤
> 

í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ì— í•„ìš”í•œ ì½”ë“œë¥¼ ì¤„ì¼ ìˆ˜ ìˆë‹¤.

*í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ : ì¶”ìƒ ë©”ì„œë“œë¥¼ ê°€ì§„ ì¸í„°í˜ì´ìŠ¤*

ëŒë‹¤ì‹ ê¸°ë³¸ êµ¬ì¡°

```java
(parameters) -> { body }
```

- parameters : ëŒë‹¤ì‹ì— ì „ë‹¬ë˜ëŠ” ì¸ìˆ˜ ëª©ë¡
- body : ëŒë‹¤ì‹ì´ ì‹¤í–‰í•  ì½”ë“œ ë¸”ë¡ í•œì¤„ì´ë©´ ìƒëµ ê°€ëŠ¥

ëŒë‹¤ì‹ì„ ì‚¬ìš©ì•ˆí•˜ê³  êµ¬í˜„ í´ë˜ìŠ¤ ìƒì„±ì‹œ

```java
Runnable withdrawRunnable = new Runnable() {
    @Override
    public void run() {
        for (int i = 0; i < 10; i++){
                bankT.withdraw(100);
            }
    }
};
```

ëŒë‹¤ì‹ ì‚¬ìš© ì‹œ

```java
Runnable withdrawRunnable = () -> {
            for (int i = 0; i < 10; i++){
                bankT.withdraw(100);
            }
        };
```